{
    "name": "Shorts_Hybrid_v2 (High Retention)",
    "nodes": [
        {
            "parameters": {
                "rule": {
                    "interval": [
                        {
                            "field": "hours"
                        }
                    ]
                }
            },
            "id": "trigger-schedule",
            "name": "Schedule Trigger",
            "type": "n8n-nodes-base.scheduleTrigger",
            "typeVersion": 1,
            "position": [
                -1200,
                0
            ]
        },
        {
            "parameters": {
                "content": "### üéØ 1. Í∏∞Ìöç & ÎåÄÎ≥∏ (Planning & Script)\n- **Target**: 60ÎåÄ Ïù¥ÏÉÅ ÏãúÎãàÏñ¥\n- **Strategy**: Hook(Í≥µÍ∞ê) -> Solution(ÎπÑÎ≤ï) -> Promise(Ìö®Í≥º)\n- **Persona**: Î≥¥ÎûåÏù¥ (ÏÜêÏ£º)",
                "height": 300,
                "width": 400,
                "color": 4
            },
            "id": "note-planning",
            "name": "Sticky Note - Planning",
            "type": "n8n-nodes-base.stickyNote",
            "typeVersion": 1,
            "position": [
                -1000,
                -200
            ]
        },
        {
            "parameters": {
                "model": {
                    "__rl": true,
                    "value": "gpt-4o",
                    "mode": "list",
                    "cachedResultName": "gpt-4o"
                },
                "options": {
                    "maxTokens": 3000,
                    "temperature": 0.7
                }
            },
            "id": "openai-chat-model",
            "name": "OpenAI Chat Model",
            "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
            "typeVersion": 1,
            "position": [
                -800,
                200
            ],
            "credentials": {
                "openAiApi": {
                    "id": "sJPPMgnhjsgphIV9",
                    "name": "OpenAi account"
                }
            }
        },
        {
            "parameters": {
                "jsonSchemaExample": "{\n  \"topic\": \"Ï£ºÏ†ú\",\n  \"narration\": \"Î¨∏Ïû•1. Î¨∏Ïû•2. Î¨∏Ïû•3. Î¨∏Ïû•4. Î¨∏Ïû•5. Î¨∏Ïû•6.\",\n  \"sentences\": [\n    \"Î¨∏Ïû•1\",\n    \"Î¨∏Ïû•2\",\n    \"Î¨∏Ïû•3\",\n    \"Î¨∏Ïû•4\",\n    \"Î¨∏Ïû•5\",\n    \"Î¨∏Ïû•6\"\n  ],\n  \"image_prompts\": [\n    \"ÌîÑÎ°¨ÌîÑÌä∏1\",\n    \"ÌîÑÎ°¨ÌîÑÌä∏2\",\n    \"ÌîÑÎ°¨ÌîÑÌä∏3\",\n    \"ÌîÑÎ°¨ÌîÑÌä∏4\",\n    \"ÌîÑÎ°¨ÌîÑÌä∏5\",\n    \"ÌîÑÎ°¨ÌîÑÌä∏6\"\n  ]\n}"
            },
            "id": "output-parser",
            "name": "Structured Output Parser",
            "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
            "typeVersion": 1,
            "position": [
                -600,
                200
            ]
        },
        {
            "parameters": {
                "promptType": "define",
                "text": "=# Context\nÏò§Îäò ÎÇ†Ïßú: {{ $now.setZone('Asia/Seoul').toFormat('yyyy-MM-dd') }}\nÌÉÄÍ≤ü: 60ÎåÄ Ïù¥ÏÉÅ ÌïúÍµ≠ ÏãúÎãàÏñ¥ (ÎÖ∏Ïïà, ÎÇúÏ≤≠ Í≥†Î†§)\n\n# Task\nÏãúÎãàÏñ¥Îì§Ïù¥ Í∞ÄÏû• Í¥ÄÏã¨ Í∞ÄÏßàÎßåÌïú 'Í±¥Í∞ï Ï£ºÏ†ú' (Ïòà: Î¨¥Î¶é ÌÜµÏ¶ù, ÎãπÎá®, Î∂àÎ©¥Ï¶ù) ÌïòÎÇòÎ•º ÏÑ†Ï†ïÌïòÍ≥†, 'Î≥¥ÎûåÏù¥' ÌéòÎ•¥ÏÜåÎÇòÎ°ú 30Ï¥à ÏáºÏ∏† ÎåÄÎ≥∏Í≥º Ïù¥ÎØ∏ÏßÄ ÌîÑÎ°¨ÌîÑÌä∏Î•º ÏûëÏÑ±ÌïòÏÑ∏Ïöî.\n\n# Persona (Î≥¥ÎûåÏù¥)\n- 5ÏÇ¥ ÏÜêÏ£º, Í∑ÄÏóΩÍ≥† ÏòàÏùòÎ∞îÎ¶Ñ\n- ÎßêÌà¨: \"Ìï†Î®∏Îãà~\", \"~Ìï¥Ïöî!\", \"ÏÇ¨ÎûëÌï¥Ïöî!\"\n- Î™©ÏÜåÎ¶¨ ÌÜ§: Ï≤úÏ≤úÌûà, ÎòêÎ∞ïÎòêÎ∞ï\n\n# Script Rules (Retention Strategy)\n1. **Hook (Î¨∏Ïû•1)**: Ï¶ùÏÉÅÏùÑ ÏΩï ÏßëÏñ¥ÏÑú ÏßàÎ¨∏ (Ïòà: \"Ìï†Î®∏Îãà, Í≥ÑÎã® ÎÇ¥Î†§Í∞à Îïå Î¨¥Î¶é ÏãúÎ¶¨Ï£†?\")\n2. **Solution (Î¨∏Ïû•2~5)**: Ïñ¥Î†µÏßÄ ÏïäÏùÄ Ìï¥Í≤∞Ï±Ö 1Í∞ÄÏßÄ Ï†úÏãú (Ï†ÑÎ¨∏ Ïö©Ïñ¥ Í∏àÏßÄ)\n3. **Promise (Î¨∏Ïû•6)**: Ìö®Í≥ºÏôÄ ÏÇ¨Îûë ÌëúÌòÑ (Ïòà: \"Í∑∏Îüº Ïö∞Î¶¨ ÏÇ∞Ï±Ö Í∞à Ïàò ÏûàÏñ¥Ïöî! ÏÇ¨ÎûëÌï¥Ïöî!\")\n4. **Length**: Ï†ïÌôïÌûà 6Î¨∏Ïû•. Î¨∏Ïû•Îãπ 40Ïûê Ïù¥ÎÇ¥.\n\n# Visual Rules (Pixar Style)\n- Î™®Îì† Ïù¥ÎØ∏ÏßÄÎäî 'Pixar style 3D animation' Ïä§ÌÉÄÏùº\n- Ï£ºÏù∏Í≥µ 'Î≥¥ÎûåÏù¥' (5ÏÇ¥ ÌïúÍµ≠ Ïó¨ÏûêÏïÑÏù¥, ÏùòÏÇ¨ Í∞ÄÏö¥)Í∞Ä Ìï≠ÏÉÅ Îì±Ïû•\n- ÏÉÅÌô©Ïóê ÎßûÎäî ÎèôÏûë Î¨òÏÇ¨ (Ïòà: Î¨¥Î¶éÏùÑ Í∞ÄÎ¶¨ÌÇ§Îäî Î≥¥ÎûåÏù¥)\n",
                "options": {
                    "systemMessage": "ÎãπÏã†ÏùÄ ÏãúÎãàÏñ¥ Ï†ÑÎ¨∏ Ïú†ÌäúÎ∏å ÌÅ¨Î¶¨ÏóêÏù¥ÌÑ∞ 'Î≥¥ÎûåÏù¥'Ïùò ÎëêÎáåÏûÖÎãàÎã§. Ïñ¥Î•¥Ïã†Îì§Ïù¥ Ïù¥Ìï¥ÌïòÍ∏∞ ÏâΩÍ≥†, Îì£Í∏∞ Ìé∏Ìïú ÏΩòÌÖêÏ∏†Î•º ÎßåÎì≠ÎãàÎã§."
                }
            },
            "id": "agent-planner",
            "name": "Agent - Strategy Planner",
            "type": "@n8n/n8n-nodes-langchain.agent",
            "typeVersion": 1,
            "position": [
                -800,
                0
            ]
        },
        {
            "parameters": {
                "jsCode": "// üéµ Robust Sentence Splitter (from Advanced Workflow)\n// Î¨∏Ïû•ÏùÑ Ï†ïÌôïÌûà 6Í∞úÎ°ú Î∂ÑÎ¶¨ÌïòÍ≥†, Î∂ÄÏ°±ÌïòÎ©¥ Ï±ÑÏõåÎÑ£Îäî Î°úÏßÅ\n\nconst input = items[0].json;\nconst narrationText = input.narration || '';\n\nconsole.log('Input Narration:', narrationText);\n\nlet splitSentences = [];\n\n// 1. Î¨∏Ïû•Î∂ÄÌò∏Î°ú Î∂ÑÎ¶¨\nsplitSentences = narrationText\n  .split(/[.!?„ÄÇ]\\s*/)\n  .map(s => s.trim())\n  .filter(s => s);\n\n// 2. 6Í∞úÍ∞Ä ÏïÑÎãàÎ©¥ Ï§ÑÎ∞îÍøàÏúºÎ°ú Ïû¨ÏãúÎèÑ\nif (splitSentences.length !== 6) {\n  const newlineSplit = narrationText.split('\\n').map(s => s.trim()).filter(s => s);\n  if (newlineSplit.length >= 2) splitSentences = newlineSplit;\n}\n\n// 3. Í∑∏ÎûòÎèÑ Î∂ÄÏ°±ÌïòÎ©¥ ÎπàÏπ∏ Ï±ÑÏö∞Í∏∞ (ÏóêÎü¨ Î∞©ÏßÄ)\nwhile (splitSentences.length < 6) splitSentences.push('ÏÇ¨ÎûëÌï¥Ïöî Ìï†Î®∏Îãà!');\n\n// 4. 6Í∞ú Ï¥àÍ≥ºÎ©¥ ÏûêÎ•¥Í∏∞\nsplitSentences = splitSentences.slice(0, 6);\n\n// 5. Ïù¥ÎØ∏ÏßÄ ÌîÑÎ°¨ÌîÑÌä∏ Îß§Ìïë\nconst imagePrompts = input.image_prompts || [];\nwhile (imagePrompts.length < 6) imagePrompts.push('Pixar style 3D animation, cute girl smiling');\n\n// Í≤∞Í≥º Î∞òÌôò\nconst results = splitSentences.map((sentence, index) => ({\n  json: {\n    sentence: sentence,\n    image_prompt: imagePrompts[index],\n    index: index + 1,\n    total: 6\n  }\n}));\n\nreturn results;"
            },
            "id": "code-splitter",
            "name": "Code - Robust Splitter",
            "type": "n8n-nodes-base.code",
            "typeVersion": 2,
            "position": [
                -400,
                0
            ]
        },
        {
            "parameters": {
                "content": "### üé® 2. Ï†úÏûë (Production)\n- **Visual**: DALL-E 3 (Pixar Style)\n- **Audio**: OpenAI TTS (Nova, 0.85x)\n- **Render**: Creatomate",
                "height": 300,
                "width": 400,
                "color": 5
            },
            "id": "note-production",
            "name": "Sticky Note - Production",
            "type": "n8n-nodes-base.stickyNote",
            "typeVersion": 1,
            "position": [
                -200,
                -200
            ]
        },
        {
            "parameters": {
                "resource": "image",
                "operation": "generate",
                "prompt": "={{ $json.image_prompt }}",
                "model": "dall-e-3",
                "options": {
                    "size": "1024x1024",
                    "quality": "standard",
                    "style": "vivid"
                }
            },
            "id": "dalle-image",
            "name": "DALL-E 3 Image",
            "type": "n8n-nodes-base.openAi",
            "typeVersion": 1,
            "position": [
                0,
                -100
            ],
            "credentials": {
                "openAiApi": {
                    "id": "sJPPMgnhjsgphIV9",
                    "name": "OpenAi account"
                }
            }
        },
        {
            "parameters": {
                "resource": "audio",
                "operation": "speech",
                "model": "tts-1-hd",
                "text": "={{ $json.sentence }}",
                "options": {
                    "voice": "nova",
                    "speed": 0.85
                }
            },
            "id": "openai-tts",
            "name": "OpenAI TTS",
            "type": "n8n-nodes-base.openAi",
            "typeVersion": 1,
            "position": [
                0,
                100
            ],
            "credentials": {
                "openAiApi": {
                    "id": "sJPPMgnhjsgphIV9",
                    "name": "OpenAi account"
                }
            }
        },
        {
            "parameters": {
                "method": "POST",
                "url": "https://api.creatomate.com/v1/renders",
                "sendBody": true,
                "bodyParameters": {
                    "parameters": [
                        {
                            "name": "template_id",
                            "value": "YOUR_TEMPLATE_ID"
                        },
                        {
                            "name": "modifications",
                            "value": "={{ {\n  \"Image\": $('DALL-E 3 Image').item.json.url,\n  \"Audio\": $('OpenAI TTS').item.json.url,\n  \"Text\": $('Code - Robust Splitter').item.json.sentence\n} }}"
                        }
                    ]
                },
                "options": {}
            },
            "id": "creatomate-render",
            "name": "Creatomate Render",
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 4.2,
            "position": [
                300,
                0
            ],
            "credentials": {
                "httpHeaderAuth": {
                    "id": "Tzlf95EWgm3pWD1A",
                    "name": "Header Auth account"
                }
            }
        }
    ],
    "connections": {
        "Schedule Trigger": {
            "main": [
                [
                    {
                        "node": "Agent - Strategy Planner",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "OpenAI Chat Model": {
            "ai_languageModel": [
                [
                    {
                        "node": "Agent - Strategy Planner",
                        "type": "ai_languageModel",
                        "index": 0
                    }
                ]
            ]
        },
        "Structured Output Parser": {
            "ai_outputParser": [
                [
                    {
                        "node": "Agent - Strategy Planner",
                        "type": "ai_outputParser",
                        "index": 0
                    }
                ]
            ]
        },
        "Agent - Strategy Planner": {
            "main": [
                [
                    {
                        "node": "Code - Robust Splitter",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Code - Robust Splitter": {
            "main": [
                [
                    {
                        "node": "DALL-E 3 Image",
                        "type": "main",
                        "index": 0
                    },
                    {
                        "node": "OpenAI TTS",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "DALL-E 3 Image": {
            "main": [
                [
                    {
                        "node": "Creatomate Render",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "OpenAI TTS": {
            "main": [
                [
                    {
                        "node": "Creatomate Render",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        }
    }
}